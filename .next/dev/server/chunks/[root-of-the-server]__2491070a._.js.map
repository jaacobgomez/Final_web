{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/jacobgomez/tercero/Web_I/Practica_Final/spotify2/Final_web/src/app/api/spotify-token/route.js"],"sourcesContent":["import { NextResponse } from 'next/server';\n\nexport async function POST(request) {\n  try {\n    const { code } = await request.json();\n\n    if (!code) {\n      return NextResponse.json(\n        { error: 'Código no proporcionado' },\n        { status: 400 }\n      );\n    }\n    console.log('Received code for token exchange:', code);\n    const clientId = process.env.SPOTIFY_CLIENT_ID;\n    const clientSecret = process.env.SPOTIFY_CLIENT_SECRET;\n    const redirectUri = process.env.NEXT_PUBLIC_REDIRECT_URI;\n\n    // Intercambiar código por tokens\n    const response = await fetch('https://accounts.spotify.com/api/token', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n        'Authorization': 'Basic ' + Buffer.from(\n          `${clientId}:${clientSecret}`\n        ).toString('base64')\n      },\n      body: new URLSearchParams({\n        grant_type: 'authorization_code',\n        code: code,\n        redirect_uri: redirectUri\n      })\n    });\n\n    const data = await response.json();\n\n    console.log('Token exchange response data:', data);\n\n    if (!response.ok) {\n      return NextResponse.json(\n        { error: data.error_description || 'Error al obtener token' },\n        { status: response.status }\n      );\n    }\n    \n\n    return NextResponse.json({\n      access_token: data.access_token,\n      refresh_token: data.refresh_token,\n      expires_in: data.expires_in\n    });\n\n  } catch (error) {\n    console.error('Error en token exchange:', error);\n    return NextResponse.json(\n      { error: 'Error interno del servidor' },\n      { status: 500 }\n    );\n  }\n}"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,KAAK,OAAO;IAChC,IAAI;QACF,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEnC,IAAI,CAAC,MAAM;YACT,OAAO,2LAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA0B,GACnC;gBAAE,QAAQ;YAAI;QAElB;QACA,QAAQ,GAAG,CAAC,qCAAqC;QACjD,MAAM,WAAW,QAAQ,GAAG,CAAC,iBAAiB;QAC9C,MAAM,eAAe,QAAQ,GAAG,CAAC,qBAAqB;QACtD,MAAM;QAEN,iCAAiC;QACjC,MAAM,WAAW,MAAM,MAAM,0CAA0C;YACrE,QAAQ;YACR,SAAS;gBACP,gBAAgB;gBAChB,iBAAiB,WAAW,OAAO,IAAI,CACrC,GAAG,SAAS,CAAC,EAAE,cAAc,EAC7B,QAAQ,CAAC;YACb;YACA,MAAM,IAAI,gBAAgB;gBACxB,YAAY;gBACZ,MAAM;gBACN,cAAc;YAChB;QACF;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAEhC,QAAQ,GAAG,CAAC,iCAAiC;QAE7C,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,OAAO,2LAAY,CAAC,IAAI,CACtB;gBAAE,OAAO,KAAK,iBAAiB,IAAI;YAAyB,GAC5D;gBAAE,QAAQ,SAAS,MAAM;YAAC;QAE9B;QAGA,OAAO,2LAAY,CAAC,IAAI,CAAC;YACvB,cAAc,KAAK,YAAY;YAC/B,eAAe,KAAK,aAAa;YACjC,YAAY,KAAK,UAAU;QAC7B;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,2LAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA6B,GACtC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}