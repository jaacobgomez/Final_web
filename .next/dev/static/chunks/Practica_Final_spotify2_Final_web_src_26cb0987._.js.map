{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/jacobgomez/tercero/Web_I/Practica_Final/spotify2/Final_web/src/lib/spotify.js"],"sourcesContent":["import { getAccessToken } from './auth';\n\nexport async function generatePlaylist(preferences) {\n  const { artists, genres, decades, popularity } = preferences;\n  const token = getAccessToken();\n  let allTracks = [];\n\n  // 1. Obtener top tracks de artistas seleccionados\n  for (const artist of artists) {\n    const tracks = await fetch(\n      `https://api.spotify.com/v1/artists/${artist.id}/top-tracks?market=US`,\n      {\n        headers: { 'Authorization': `Bearer ${token}` }\n      }\n    );\n    const data = await tracks.json();\n    allTracks.push(...data.tracks);\n  }\n\n  // 2. Buscar por géneros\n  for (const genre of genres) {\n    const results = await fetch(\n      `https://api.spotify.com/v1/search?type=track&q=genre:${genre}&limit=20`,\n      {\n        headers: { 'Authorization': `Bearer ${token}` }\n      }\n    );\n    const data = await results.json();\n    allTracks.push(...data.tracks.items);\n  }\n\n  // 3. Filtrar por década\n  if (decades.length > 0) {\n    allTracks = allTracks.filter(track => {\n      const year = new Date(track.album.release_date).getFullYear();\n      return decades.some(decade => {\n        const decadeStart = parseInt(decade);\n        return year >= decadeStart && year < decadeStart + 10;\n      });\n    });\n  }\n\n  // 4. Filtrar por popularidad\n  if (popularity) {\n    const [min, max] = popularity;\n    allTracks = allTracks.filter(\n      track => track.popularity >= min && track.popularity <= max\n    );\n  }\n\n  // 5. Eliminar duplicados y limitar a 30 canciones\n  const uniqueTracks = Array.from(\n    new Map(allTracks.map(track => [track.id, track])).values()\n  ).slice(0, 30);\n\n  return uniqueTracks;\n}\n\nexport async function getRandomSpotifyImage() {\n  const token = getAccessToken();\n  if (!token) {\n    throw new Error('No hay token de Spotify. Inicia sesión primero.');\n  }\n\n  const res = await fetch(\n    'https://api.spotify.com/v1/browse/new-releases?limit=20',\n    {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    }\n  );\n\n  if (!res.ok) {\n    const text = await res.text();\n    console.error('Error al pedir new releases:', res.status, text);\n    throw new Error('Error al pedir datos a Spotify');\n  }\n\n  const data = await res.json();\n  const albums = data.albums.items;\n  if (!albums.length) {\n    throw new Error('Spotify no devolvió álbumes');\n  }\n\n  const randomIndex = Math.floor(Math.random() * albums.length);\n  const album = albums[randomIndex];\n\n  return {\n    url: album.images[0]?.url || '',\n    name: album.name,\n    artist: album.artists?.[0]?.name || '',\n  };\n}\n//Buscar artistas \n// Pequeña función para leer el token del localStorage de forma segura\nfunction obtenerTokenCliente() {\n  if (typeof window === \"undefined\") return null;\n\n  try {\n    return localStorage.getItem(\"spotify_token\") || null;\n  } catch (error) {\n    console.error(\"No se pudo leer el token de Spotify del localStorage\", error);\n    return null;\n  }\n}\n\nexport async function buscarArtistasSpotify(terminoBusqueda) {\n  const token = obtenerTokenCliente();\n\n  if (!token) {\n    throw new Error(\n      \"No hay token de Spotify. Inicia sesión de nuevo para buscar artistas.\"\n    );\n  }\n\n  const parametros = new URLSearchParams({\n    type: \"artist\",\n    q: terminoBusqueda,\n    limit: \"10\",\n  });\n\n  const respuesta = await fetch(\n    `https://api.spotify.com/v1/search?${parametros.toString()}`,\n    {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    }\n  );\n\n  if (respuesta.status === 401) {\n    throw new Error(\"El token de Spotify ha expirado. Vuelve a iniciar sesión.\");\n  }\n\n  if (!respuesta.ok) {\n    throw new Error(\n      `Error al buscar artistas (código ${respuesta.status}). Inténtalo de nuevo.`\n    );\n  }\n\n  const datos = await respuesta.json();\n  return datos.artists?.items || [];\n}\n\n// Búsqueda de canciones en la Web API de Spotify\nexport async function buscarCancionesSpotify(terminoBusqueda) {\n  const token = obtenerTokenCliente();\n\n  if (!token) {\n    throw new Error(\n      \"No hay token de Spotify. Inicia sesión de nuevo para buscar canciones.\"\n    );\n  }\n\n  const parametros = new URLSearchParams({\n    type: \"track\",\n    q: terminoBusqueda,\n    limit: \"10\",\n  });\n\n  const respuesta = await fetch(\n    `https://api.spotify.com/v1/search?${parametros.toString()}`,\n    {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    }\n  );\n\n  if (respuesta.status === 401) {\n    throw new Error(\"El token de Spotify ha expirado. Vuelve a iniciar sesión.\");\n  }\n\n  if (!respuesta.ok) {\n    throw new Error(\n      `Error al buscar canciones (código ${respuesta.status}). Inténtalo de nuevo.`\n    );\n  }\n\n  const datos = await respuesta.json();\n  return datos.tracks?.items || [];\n}\n\n// Obtener top tracks de un artista\nexport async function obtenerTopTracksArtista(artistId, market = \"ES\") {\n  const token = obtenerTokenCliente();\n  if (!token) {\n    throw new Error(\"No hay token de Spotify para cargar top tracks.\");\n  }\n\n  const respuesta = await fetch(\n    `https://api.spotify.com/v1/artists/${artistId}/top-tracks?market=${market}`,\n    {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    }\n  );\n\n  if (respuesta.status === 401) {\n    throw new Error(\"El token de Spotify ha expirado. Vuelve a iniciar sesión.\");\n  }\n\n  if (!respuesta.ok) {\n    throw new Error(\n      `Error al obtener top tracks del artista (código ${respuesta.status}).`\n    );\n  }\n\n  const datos = await respuesta.json();\n  return datos.tracks || [];\n}\n\n// Buscar canciones por género\nexport async function buscarTracksPorGenero(genero, limit = 10) {\n  const token = obtenerTokenCliente();\n  if (!token) {\n    throw new Error(\"No hay token de Spotify para buscar por género.\");\n  }\n\n  const parametros = new URLSearchParams({\n    type: \"track\",\n    q: `genre:${genero}`,\n    limit: String(limit),\n  });\n\n  const respuesta = await fetch(\n    `https://api.spotify.com/v1/search?${parametros.toString()}`,\n    {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    }\n  );\n\n  if (respuesta.status === 401) {\n    throw new Error(\"El token de Spotify ha expirado. Vuelve a iniciar sesión.\");\n  }\n\n  if (!respuesta.ok) {\n    throw new Error(\n      `Error al buscar canciones por género (código ${respuesta.status}).`\n    );\n  }\n\n  const datos = await respuesta.json();\n  return datos.tracks?.items || [];\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 204, "column": 0}, "map": {"version":3,"sources":["file:///home/jacobgomez/tercero/Web_I/Practica_Final/spotify2/Final_web/src/components/Widgets/GenreWidget.jsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\n\nconst TODOS_LOS_GENEROS = [\n  \"acoustic\",\n  \"afrobeat\",\n  \"alt-rock\",\n  \"alternative\",\n  \"ambient\",\n  \"anime\",\n  \"blues\",\n  \"brazil\",\n  \"chill\",\n  \"classical\",\n  \"dance\",\n  \"disco\",\n  \"edm\",\n  \"electronic\",\n  \"folk\",\n  \"funk\",\n  \"hip-hop\",\n  \"house\",\n  \"indie\",\n  \"indie-pop\",\n  \"jazz\",\n  \"k-pop\",\n  \"latin\",\n  \"metal\",\n  \"pop\",\n  \"punk\",\n  \"r-n-b\",\n  \"reggae\",\n  \"reggaeton\",\n  \"rock\",\n  \"soul\",\n  \"techno\",\n  \"trance\",\n  \"world-music\",\n];\n\nexport default function GenreWidget({\n  generosSeleccionados,\n  onCambiarGeneros,\n}) \n\n{\n    const [busqueda, setBusqueda] = useState(\"\");\n\n  // Filtramos la lista según el texto que escribe el usuario\n  const generosFiltrados = TODOS_LOS_GENEROS.filter((genero) =>\n    genero.toLowerCase().includes(busqueda.toLowerCase())\n  );\n\n  const limiteSeleccion = 5;\n\n  const manejarClickGenero = (genero) => {\n    // Si ya está seleccionado, lo quitamos\n    if (generosSeleccionados.includes(genero)) {\n      const nuevaLista = generosSeleccionados.filter((g) => g !== genero);\n      onCambiarGeneros(nuevaLista);\n      return;\n    }\n\n    // Si NO está seleccionado y ya hemos llegado al límite, no dejamos añadir más\n    if (generosSeleccionados.length >= limiteSeleccion) {\n      alert(`Solo puedes seleccionar hasta ${limiteSeleccion} géneros.`);\n      return;\n    }\n\n    const nuevaLista = [...generosSeleccionados, genero];\n    onCambiarGeneros(nuevaLista);\n  };\n\nreturn (   \n    <div className=\"card widget-generos\">\n        <h3 className=\"widget-titulo\">Géneros favoritos</h3>\n        <p className=\"widget-texto\">\n            Escribe para filtrar y elige hasta {limiteSeleccion} géneros que te\n            representen.\n        </p>\n\n        <input\n            type=\"text\"\n            placeholder=\"Buscar género (ej. rock, jazz, pop)...\"\n            className=\"widget-input\"\n            value={busqueda}\n            onChange={(e) => setBusqueda(e.target.value)}\n        />\n\n        <div className=\"lista-generos\">\n            {generosFiltrados.map((genero) => {\n            const estaSeleccionado = generosSeleccionados.includes(genero);\n            return (\n                <button\n                key={genero}\n                type=\"button\"\n                className={`boton-genero ${\n                    estaSeleccionado ? \"boton-genero-activo\" : \"\"\n                }`}\n                onClick={() => manejarClickGenero(genero)}\n                >\n                {genero}\n                </button>\n            );\n            })}\n        </div>\n\n        {generosSeleccionados.length > 0 && (\n            <p className=\"texto-seleccionados\">\n            Seleccionados: {generosSeleccionados.join(\", \")}\n            </p>\n        )}\n    </div>\n  );\n}\n    "],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AAIA,MAAM,oBAAoB;IACxB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAEc,SAAS,YAAY,EAClC,oBAAoB,EACpB,gBAAgB,EACjB;;IAGG,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,oNAAQ,EAAC;IAE3C,2DAA2D;IAC3D,MAAM,mBAAmB,kBAAkB,MAAM,CAAC,CAAC,SACjD,OAAO,WAAW,GAAG,QAAQ,CAAC,SAAS,WAAW;IAGpD,MAAM,kBAAkB;IAExB,MAAM,qBAAqB,CAAC;QAC1B,uCAAuC;QACvC,IAAI,qBAAqB,QAAQ,CAAC,SAAS;YACzC,MAAM,aAAa,qBAAqB,MAAM,CAAC,CAAC,IAAM,MAAM;YAC5D,iBAAiB;YACjB;QACF;QAEA,8EAA8E;QAC9E,IAAI,qBAAqB,MAAM,IAAI,iBAAiB;YAClD,MAAM,CAAC,8BAA8B,EAAE,gBAAgB,SAAS,CAAC;YACjE;QACF;QAEA,MAAM,aAAa;eAAI;YAAsB;SAAO;QACpD,iBAAiB;IACnB;IAEF,qBACI,wOAAC;QAAI,WAAU;;0BACX,wOAAC;gBAAG,WAAU;0BAAgB;;;;;;0BAC9B,wOAAC;gBAAE,WAAU;;oBAAe;oBACY;oBAAgB;;;;;;;0BAIxD,wOAAC;gBACG,MAAK;gBACL,aAAY;gBACZ,WAAU;gBACV,OAAO;gBACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;;;;;;0BAG/C,wOAAC;gBAAI,WAAU;0BACV,iBAAiB,GAAG,CAAC,CAAC;oBACvB,MAAM,mBAAmB,qBAAqB,QAAQ,CAAC;oBACvD,qBACI,wOAAC;wBAED,MAAK;wBACL,WAAW,CAAC,aAAa,EACrB,mBAAmB,wBAAwB,IAC7C;wBACF,SAAS,IAAM,mBAAmB;kCAEjC;uBAPI;;;;;gBAUT;;;;;;YAGH,qBAAqB,MAAM,GAAG,mBAC3B,wOAAC;gBAAE,WAAU;;oBAAsB;oBACnB,qBAAqB,IAAI,CAAC;;;;;;;;;;;;;AAKtD;GA1EwB;KAAA"}},
    {"offset": {"line": 357, "column": 0}, "map": {"version":3,"sources":["file:///home/jacobgomez/tercero/Web_I/Practica_Final/spotify2/Final_web/src/components/Widgets/DecadeWidget.jsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\n\nconst TODAS_LAS_DECADAS = [\n  \"1950s\",\n  \"1960s\",\n  \"1970s\",\n  \"1980s\",\n  \"1990s\",\n  \"2000s\",\n  \"2010s\",\n  \"2020s\",\n];\n\nexport default function DecadeWidget({\n  decadasSeleccionadas,\n  onCambiarDecadas,\n}) {\n  const [mostrarMasInfo, setMostrarMasInfo] = useState(false);\n  const limiteSeleccion = 3;\n\n  const manejarClickDecada = (decada) => {\n    // Si ya está seleccionada, la quitamos\n    if (decadasSeleccionadas.includes(decada)) {\n      const nuevaLista = decadasSeleccionadas.filter((d) => d !== decada);\n      onCambiarDecadas(nuevaLista);\n      return;\n    }\n\n    // Límite de décadas seleccionadas\n    if (decadasSeleccionadas.length >= limiteSeleccion) {\n      alert(`Solo puedes seleccionar hasta ${limiteSeleccion} décadas.`);\n      return;\n    }\n\n    const nuevaLista = [...decadasSeleccionadas, decada];\n    onCambiarDecadas(nuevaLista);\n  };\n\n  return (\n    <div className=\"card widget-decadas\">\n      <h3 className=\"widget-titulo\">Décadas preferidas</h3>\n      <p className=\"widget-texto\">\n        Elige las épocas musicales que más te gustan. Usaremos estas décadas\n        para filtrar la música.\n      </p>\n\n      <div className=\"lista-decadas\">\n        {TODAS_LAS_DECADAS.map((decada) => {\n          const activa = decadasSeleccionadas.includes(decada);\n          return (\n            <button\n              key={decada}\n              type=\"button\"\n              className={`boton-decada ${activa ? \"boton-decada-activa\" : \"\"}`}\n              onClick={() => manejarClickDecada(decada)}\n            >\n              {decada}\n            </button>\n          );\n        })}\n      </div>\n\n      {decadasSeleccionadas.length > 0 && (\n        <p className=\"texto-seleccionados\">\n          Has seleccionado: {decadasSeleccionadas.join(\", \")}\n        </p>\n      )}\n\n      <button\n        type=\"button\"\n        className=\"boton-info-decadas\"\n        onClick={() => setMostrarMasInfo(!mostrarMasInfo)}\n      >\n        {mostrarMasInfo ? \"Ocultar detalle\" : \"¿Qué significa cada década?\"}\n      </button>\n\n      {mostrarMasInfo && (\n        <ul className=\"lista-detalle-decadas\">\n          <li>1950s → 1950 - 1959</li>\n          <li>1960s → 1960 - 1969</li>\n          <li>1970s → 1970 - 1979</li>\n          <li>1980s → 1980 - 1989</li>\n          <li>1990s → 1990 - 1999</li>\n          <li>2000s → 2000 - 2009</li>\n          <li>2010s → 2010 - 2019</li>\n          <li>2020s → 2020 - 2029</li>\n        </ul>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AAIA,MAAM,oBAAoB;IACxB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAEc,SAAS,aAAa,EACnC,oBAAoB,EACpB,gBAAgB,EACjB;;IACC,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,oNAAQ,EAAC;IACrD,MAAM,kBAAkB;IAExB,MAAM,qBAAqB,CAAC;QAC1B,uCAAuC;QACvC,IAAI,qBAAqB,QAAQ,CAAC,SAAS;YACzC,MAAM,aAAa,qBAAqB,MAAM,CAAC,CAAC,IAAM,MAAM;YAC5D,iBAAiB;YACjB;QACF;QAEA,kCAAkC;QAClC,IAAI,qBAAqB,MAAM,IAAI,iBAAiB;YAClD,MAAM,CAAC,8BAA8B,EAAE,gBAAgB,SAAS,CAAC;YACjE;QACF;QAEA,MAAM,aAAa;eAAI;YAAsB;SAAO;QACpD,iBAAiB;IACnB;IAEA,qBACE,wOAAC;QAAI,WAAU;;0BACb,wOAAC;gBAAG,WAAU;0BAAgB;;;;;;0BAC9B,wOAAC;gBAAE,WAAU;0BAAe;;;;;;0BAK5B,wOAAC;gBAAI,WAAU;0BACZ,kBAAkB,GAAG,CAAC,CAAC;oBACtB,MAAM,SAAS,qBAAqB,QAAQ,CAAC;oBAC7C,qBACE,wOAAC;wBAEC,MAAK;wBACL,WAAW,CAAC,aAAa,EAAE,SAAS,wBAAwB,IAAI;wBAChE,SAAS,IAAM,mBAAmB;kCAEjC;uBALI;;;;;gBAQX;;;;;;YAGD,qBAAqB,MAAM,GAAG,mBAC7B,wOAAC;gBAAE,WAAU;;oBAAsB;oBACd,qBAAqB,IAAI,CAAC;;;;;;;0BAIjD,wOAAC;gBACC,MAAK;gBACL,WAAU;gBACV,SAAS,IAAM,kBAAkB,CAAC;0BAEjC,iBAAiB,oBAAoB;;;;;;YAGvC,gCACC,wOAAC;gBAAG,WAAU;;kCACZ,wOAAC;kCAAG;;;;;;kCACJ,wOAAC;kCAAG;;;;;;kCACJ,wOAAC;kCAAG;;;;;;kCACJ,wOAAC;kCAAG;;;;;;kCACJ,wOAAC;kCAAG;;;;;;kCACJ,wOAAC;kCAAG;;;;;;kCACJ,wOAAC;kCAAG;;;;;;kCACJ,wOAAC;kCAAG;;;;;;;;;;;;;;;;;;AAKd;GA7EwB;KAAA"}},
    {"offset": {"line": 542, "column": 0}, "map": {"version":3,"sources":["file:///home/jacobgomez/tercero/Web_I/Practica_Final/spotify2/Final_web/src/components/Widgets/PopularityWidget.jsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\n\nconst OPCIONES = {\n  underground: { min: 0, max: 40, etiqueta: \"Underground (0 - 40)\" },\n  popular: { min: 40, max: 75, etiqueta: \"Popular (40 - 75)\" },\n  mainstream: { min: 75, max: 100, etiqueta: \"Mainstream (75 - 100)\" },\n};\n\nexport default function PopularityWidget({ popularidad, onCambiarPopularidad }) {\n  const [opcionSeleccionada, setOpcionSeleccionada] = useState(\"popular\");\n\n  // Cuando cambie la popularidad desde fuera, intentamos ajustar la opción\n  useEffect(() => {\n    if (!popularidad) return;\n\n    const { min, max } = popularidad;\n\n    if (min === OPCIONES.underground.min && max === OPCIONES.underground.max) {\n      setOpcionSeleccionada(\"underground\");\n    } else if (min === OPCIONES.popular.min && max === OPCIONES.popular.max) {\n      setOpcionSeleccionada(\"popular\");\n    } else if (\n      min === OPCIONES.mainstream.min &&\n      max === OPCIONES.mainstream.max\n    ) {\n      setOpcionSeleccionada(\"mainstream\");\n    } else {\n      setOpcionSeleccionada(\"personalizado\");\n    }\n  }, [popularidad]);\n\n  const manejarClickOpcion = (opcionClave) => {\n    if (opcionClave === \"personalizado\") {\n      setOpcionSeleccionada(\"personalizado\");\n      return;\n    }\n\n    const rango = OPCIONES[opcionClave];\n    setOpcionSeleccionada(opcionClave);\n    onCambiarPopularidad({ min: rango.min, max: rango.max });\n  };\n  /* El slider del widget me da un valor de 0 a 100, que yo interpreto como el centro del rango de popularidad. \n  Uso una constante amplitud = 10 para construir alrededor de ese centro un intervalo [valor - 10, valor + 10], \n  y lo recorto entre 0 y 100 con Math.max y Math.min. Así siempre trabajo con un rango (mínimo y máximo) en lugar \n  de un solo número*/\n  const manejarCambioSlider = (e) => {\n    const valor = Number(e.target.value);\n    // Creamos un rango pequeño alrededor del valor central\n    const amplitud = 10;\n    const min = Math.max(0, valor - amplitud);\n    const max = Math.min(100, valor + amplitud);\n\n    onCambiarPopularidad({ min, max });\n    setOpcionSeleccionada(\"personalizado\");\n  };\n\n  return (\n    <div className=\"card widget-popularidad\">\n      <h3 className=\"widget-titulo\">Nivel de popularidad</h3>\n      <p className=\"widget-texto\">\n        Decide si quieres descubrimientos más alternativos o temas muy conocidos.\n      </p>\n\n      {/* Botones de selección rápida */}\n      <div className=\"botones-popularidad\">\n        <button\n          type=\"button\"\n          className={`boton-popularidad ${\n            opcionSeleccionada === \"underground\" ? \"boton-popularidad-activo\" : \"\"\n          }`}\n          onClick={() => manejarClickOpcion(\"underground\")}\n        >\n          Underground\n        </button>\n\n        <button\n          type=\"button\"\n          className={`boton-popularidad ${\n            opcionSeleccionada === \"popular\" ? \"boton-popularidad-activo\" : \"\"\n          }`}\n          onClick={() => manejarClickOpcion(\"popular\")}\n        >\n          Popular\n        </button>\n\n        <button\n          type=\"button\"\n          className={`boton-popularidad ${\n            opcionSeleccionada === \"mainstream\" ? \"boton-popularidad-activo\" : \"\"\n          }`}\n          onClick={() => manejarClickOpcion(\"mainstream\")}\n        >\n          Mainstream\n        </button>\n      </div>\n\n      {/* Slider para ajustar a mano */}\n      <div className=\"popularidad-slider-bloque\">\n        <label className=\"popularidad-label\">\n          Ajuste fino (personalizado)\n        </label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          step=\"1\"\n          className=\"popularidad-slider\"\n          value={Math.round((popularidad.min + popularidad.max) / 2)}\n          onChange={manejarCambioSlider}\n        />\n        <div className=\"popularidad-rango\">\n          <span>Mín: {popularidad.min}</span>\n          <span>Máx: {popularidad.max}</span>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AAIA,MAAM,WAAW;IACf,aAAa;QAAE,KAAK;QAAG,KAAK;QAAI,UAAU;IAAuB;IACjE,SAAS;QAAE,KAAK;QAAI,KAAK;QAAI,UAAU;IAAoB;IAC3D,YAAY;QAAE,KAAK;QAAI,KAAK;QAAK,UAAU;IAAwB;AACrE;AAEe,SAAS,iBAAiB,EAAE,WAAW,EAAE,oBAAoB,EAAE;;IAC5E,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,oNAAQ,EAAC;IAE7D,yEAAyE;IACzE,IAAA,qNAAS;sCAAC;YACR,IAAI,CAAC,aAAa;YAElB,MAAM,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG;YAErB,IAAI,QAAQ,SAAS,WAAW,CAAC,GAAG,IAAI,QAAQ,SAAS,WAAW,CAAC,GAAG,EAAE;gBACxE,sBAAsB;YACxB,OAAO,IAAI,QAAQ,SAAS,OAAO,CAAC,GAAG,IAAI,QAAQ,SAAS,OAAO,CAAC,GAAG,EAAE;gBACvE,sBAAsB;YACxB,OAAO,IACL,QAAQ,SAAS,UAAU,CAAC,GAAG,IAC/B,QAAQ,SAAS,UAAU,CAAC,GAAG,EAC/B;gBACA,sBAAsB;YACxB,OAAO;gBACL,sBAAsB;YACxB;QACF;qCAAG;QAAC;KAAY;IAEhB,MAAM,qBAAqB,CAAC;QAC1B,IAAI,gBAAgB,iBAAiB;YACnC,sBAAsB;YACtB;QACF;QAEA,MAAM,QAAQ,QAAQ,CAAC,YAAY;QACnC,sBAAsB;QACtB,qBAAqB;YAAE,KAAK,MAAM,GAAG;YAAE,KAAK,MAAM,GAAG;QAAC;IACxD;IACA;;;mBAGiB,GACjB,MAAM,sBAAsB,CAAC;QAC3B,MAAM,QAAQ,OAAO,EAAE,MAAM,CAAC,KAAK;QACnC,uDAAuD;QACvD,MAAM,WAAW;QACjB,MAAM,MAAM,KAAK,GAAG,CAAC,GAAG,QAAQ;QAChC,MAAM,MAAM,KAAK,GAAG,CAAC,KAAK,QAAQ;QAElC,qBAAqB;YAAE;YAAK;QAAI;QAChC,sBAAsB;IACxB;IAEA,qBACE,wOAAC;QAAI,WAAU;;0BACb,wOAAC;gBAAG,WAAU;0BAAgB;;;;;;0BAC9B,wOAAC;gBAAE,WAAU;0BAAe;;;;;;0BAK5B,wOAAC;gBAAI,WAAU;;kCACb,wOAAC;wBACC,MAAK;wBACL,WAAW,CAAC,kBAAkB,EAC5B,uBAAuB,gBAAgB,6BAA6B,IACpE;wBACF,SAAS,IAAM,mBAAmB;kCACnC;;;;;;kCAID,wOAAC;wBACC,MAAK;wBACL,WAAW,CAAC,kBAAkB,EAC5B,uBAAuB,YAAY,6BAA6B,IAChE;wBACF,SAAS,IAAM,mBAAmB;kCACnC;;;;;;kCAID,wOAAC;wBACC,MAAK;wBACL,WAAW,CAAC,kBAAkB,EAC5B,uBAAuB,eAAe,6BAA6B,IACnE;wBACF,SAAS,IAAM,mBAAmB;kCACnC;;;;;;;;;;;;0BAMH,wOAAC;gBAAI,WAAU;;kCACb,wOAAC;wBAAM,WAAU;kCAAoB;;;;;;kCAGrC,wOAAC;wBACC,MAAK;wBACL,KAAI;wBACJ,KAAI;wBACJ,MAAK;wBACL,WAAU;wBACV,OAAO,KAAK,KAAK,CAAC,CAAC,YAAY,GAAG,GAAG,YAAY,GAAG,IAAI;wBACxD,UAAU;;;;;;kCAEZ,wOAAC;wBAAI,WAAU;;0CACb,wOAAC;;oCAAK;oCAAM,YAAY,GAAG;;;;;;;0CAC3B,wOAAC;;oCAAK;oCAAM,YAAY,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;AAKrC;GA7GwB;KAAA"}},
    {"offset": {"line": 752, "column": 0}, "map": {"version":3,"sources":["file:///home/jacobgomez/tercero/Web_I/Practica_Final/spotify2/Final_web/src/components/Widgets/ArtistWidget.jsx"],"sourcesContent":["/* eslint-disable @next/next/no-img-element */\n\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { buscarArtistasSpotify } from \"@/lib/spotify\";\n\nexport default function ArtistWidget({\n  artistasSeleccionados,\n  onCambiarArtistas,\n}) {\n  const [busqueda, setBusqueda] = useState(\"\");\n  const [resultados, setResultados] = useState([]);\n  const [cargando, setCargando] = useState(false);\n  const [error, setError] = useState(\"\");\n\n  const limiteSeleccion = 5;\n\n  // Buscar artistas con \"debounce\"\n  useEffect(() => {\n    // Si el texto es muy corto, no buscamos\n    if (!busqueda || busqueda.trim().length < 2) {\n      setResultados([]);\n      setError(\"\");\n      return;\n    }\n\n    setCargando(true);\n    setError(\"\");\n\n    const idTimeout = setTimeout(async () => {\n      try {\n        const artistas = await buscarArtistasSpotify(busqueda.trim());\n        setResultados(artistas);\n      } catch (err) {\n        console.error(err);\n        setError(err.message || \"Error al buscar artistas.\");\n        setResultados([]);\n      } finally {\n        setCargando(false);\n      }\n    }, 500); // esperamos 500ms desde que el usuario deja de escribir\n\n    // limpiar timeout si el usuario sigue escribiendo\n    return () => clearTimeout(idTimeout);\n  }, [busqueda]); // solo depende del texto de búsqueda\n\n  const manejarClickArtista = (artista) => {\n    const yaEsta = artistasSeleccionados.some((a) => a.id === artista.id);\n\n    if (yaEsta) {\n      // quitar de la lista\n      const nuevaLista = artistasSeleccionados.filter(\n        (a) => a.id !== artista.id\n      );\n      onCambiarArtistas(nuevaLista);\n      return;\n    }\n\n    if (artistasSeleccionados.length >= limiteSeleccion) {\n      alert(`Solo puedes seleccionar hasta ${limiteSeleccion} artistas.`);\n      return;\n    }\n\n    const nuevaLista = [...artistasSeleccionados, artista];\n    onCambiarArtistas(nuevaLista);\n  };\n\n  return (\n    <div className=\"card widget-artistas\">\n      <h3 className=\"widget-titulo\">Artistas favoritos</h3>\n      <p className=\"widget-texto\">\n        Busca artistas por nombre y selecciona hasta {limiteSeleccion}. Usaremos\n        sus canciones más populares al generar la playlist.\n      </p>\n\n      <input\n        type=\"text\"\n        placeholder=\"Buscar artista (ej. Queen, Rosalía, Bad Bunny)...\"\n        className=\"widget-input\"\n        value={busqueda}\n        onChange={(e) => setBusqueda(e.target.value)}\n      />\n\n      {cargando && (\n        <p className=\"texto-estado-busqueda\">Buscando artistas...</p>\n      )}\n\n      {error && !cargando && (\n        <p className=\"texto-error-busqueda\">{error}</p>\n      )}\n\n      {!cargando && !error && resultados.length > 0 && (\n        <ul className=\"lista-artistas\">\n          {resultados.map((artista) => {\n            const imagen =\n              artista.images && artista.images.length > 0\n                ? artista.images[artista.images.length - 1].url // la más pequeña\n                : null;\n\n            const estaSeleccionado = artistasSeleccionados.some(\n              (a) => a.id === artista.id\n            );\n\n            return (\n              <li key={artista.id}>\n                <button\n                  type=\"button\"\n                  className={`item-artista ${\n                    estaSeleccionado ? \"item-artista-seleccionado\" : \"\"\n                  }`}\n                  onClick={() => manejarClickArtista(artista)}\n                >\n                  {imagen && (\n                    <img\n                      src={imagen}\n                      alt={artista.name}\n                      className=\"imagen-artista\"\n                    />\n                  )}\n                  <div className=\"info-artista\">\n                    <span className=\"nombre-artista\">{artista.name}</span>\n                    <span className=\"detalle-artista\">\n                      Popularidad: {artista.popularity} · Seguidores:{\" \"}\n                      {artista.followers?.total?.toLocaleString(\"es-ES\")}\n                    </span>\n                  </div>\n                </button>\n              </li>\n            );\n          })}\n        </ul>\n      )}\n\n      {artistasSeleccionados.length > 0 && (\n        <div className=\"seleccion-artistas\">\n          <p className=\"texto-seleccionados\">Artistas seleccionados:</p>\n          <div className=\"chips-artistas\">\n            {artistasSeleccionados.map((artista) => (\n              <span key={artista.id} className=\"chip-artista\">\n                {artista.name}\n              </span>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 991, "column": 0}, "map": {"version":3,"sources":["file:///home/jacobgomez/tercero/Web_I/Practica_Final/spotify2/Final_web/src/components/Widgets/TrackWidget.jsx"],"sourcesContent":["/* eslint-disable @next/next/no-img-element */\n\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { buscarCancionesSpotify } from \"@/lib/spotify\";\n\nexport default function TrackWidget({\n  cancionesSeleccionadas,\n  onCambiarCanciones,\n}) {\n  const [busqueda, setBusqueda] = useState(\"\");\n  const [resultados, setResultados] = useState([]);\n  const [cargando, setCargando] = useState(false);\n  const [error, setError] = useState(\"\");\n\n  const limiteSeleccion = 5;\n\n  // Búsqueda con pequeño debounce\n  useEffect(() => {\n    if (!busqueda || busqueda.trim().length < 2) {\n      setResultados([]);\n      setError(\"\");\n      return;\n    }\n\n    setCargando(true);\n    setError(\"\");\n\n    const idTimeout = setTimeout(async () => {\n      try {\n        const canciones = await buscarCancionesSpotify(busqueda.trim());\n        setResultados(canciones);\n      } catch (err) {\n        console.error(err);\n        setError(err.message || \"Error al buscar canciones.\");\n        setResultados([]);\n      } finally {\n        setCargando(false);\n      }\n    }, 500);\n\n    return () => clearTimeout(idTimeout);\n  }, [busqueda]);\n\n  const manejarClickCancion = (cancion) => {\n    const yaEsta = cancionesSeleccionadas.some((c) => c.id === cancion.id);\n\n    if (yaEsta) {\n      const nuevaLista = cancionesSeleccionadas.filter(\n        (c) => c.id !== cancion.id\n      );\n      onCambiarCanciones(nuevaLista);\n      return;\n    }\n\n    if (cancionesSeleccionadas.length >= limiteSeleccion) {\n      alert(`Solo puedes seleccionar hasta ${limiteSeleccion} canciones.`);\n      return;\n    }\n\n    const nuevaLista = [...cancionesSeleccionadas, cancion];\n    onCambiarCanciones(nuevaLista);\n  };\n\n  return (\n    <div className=\"card widget-canciones\">\n      <h3 className=\"widget-titulo\">Canciones favoritas</h3>\n      <p className=\"widget-texto\">\n        Busca canciones concretas y selecciónalas como referencia. También\n        podrás marcarlas como favoritas más adelante.\n      </p>\n\n      <input\n        type=\"text\"\n        placeholder=\"Buscar canción (ej. Blinding Lights, As It Was)...\"\n        className=\"widget-input\"\n        value={busqueda}\n        onChange={(e) => setBusqueda(e.target.value)}\n      />\n\n      {cargando && (\n        <p className=\"texto-estado-busqueda\">Buscando canciones...</p>\n      )}\n\n      {error && !cargando && (\n        <p className=\"texto-error-busqueda\">{error}</p>\n      )}\n\n      {!cargando && !error && resultados.length > 0 && (\n        <ul className=\"lista-canciones\">\n          {resultados.map((cancion) => {\n            const imagen =\n              cancion.album?.images && cancion.album.images.length > 0\n                ? cancion.album.images[cancion.album.images.length - 1].url\n                : null;\n\n            const artistasTexto = cancion.artists\n              ?.map((a) => a.name)\n              .join(\", \");\n\n            const estaSeleccionada = cancionesSeleccionadas.some(\n              (c) => c.id === cancion.id\n            );\n\n            return (\n              <li key={cancion.id}>\n                <button\n                  type=\"button\"\n                  className={`item-cancion ${\n                    estaSeleccionada ? \"item-cancion-seleccionada\" : \"\"\n                  }`}\n                  onClick={() => manejarClickCancion(cancion)}\n                >\n                  {imagen && (\n                    <img\n                      src={imagen}\n                      alt={cancion.name}\n                      className=\"imagen-cancion\"\n                    />\n                  )}\n\n                  <div className=\"info-cancion\">\n                    <span className=\"nombre-cancion\">{cancion.name}</span>\n                    <span className=\"detalle-cancion\">\n                      {artistasTexto} · {cancion.album?.name}\n                    </span>\n                  </div>\n\n                  {cancion.explicit && (\n                    <span className=\"etiqueta-explicit\">E</span>\n                  )}\n                </button>\n              </li>\n            );\n          })}\n        </ul>\n      )}\n\n      {cancionesSeleccionadas.length > 0 && (\n        <div className=\"seleccion-canciones\">\n          <p className=\"texto-seleccionados\">Canciones seleccionadas:</p>\n          <div className=\"chips-canciones\">\n            {cancionesSeleccionadas.map((cancion) => (\n              <span key={cancion.id} className=\"chip-cancion\">\n                {cancion.name}\n              </span>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1229, "column": 0}, "map": {"version":3,"sources":["file:///home/jacobgomez/tercero/Web_I/Practica_Final/spotify2/Final_web/src/components/TrackCard.jsx"],"sourcesContent":["/* eslint-disable @next/next/no-img-element */\n\"use client\";\n\nexport default function TrackCard({\n  track,\n  esFavorito,\n  onToggleFavorito,\n  onEliminar,\n}) {\n  const imagen =\n    track.album?.images && track.album.images.length > 0\n      ? track.album.images[track.album.images.length - 1].url\n      : null;\n\n  const artistas = track.artists?.map((a) => a.name).join(\", \");\n  const duracionMs = track.duration_ms || 0;\n  const minutos = Math.floor(duracionMs / 60000);\n  const segundos = Math.floor((duracionMs % 60000) / 1000)\n    .toString()\n    .padStart(2, \"0\");\n\n  return (\n    <div className=\"track-card\">\n      {imagen && (\n        <img src={imagen} alt={track.name} className=\"track-card-imagen\" />\n      )}\n\n      <div className=\"track-card-info\">\n        <div className=\"track-card-titulos\">\n          <span className=\"track-card-nombre\">{track.name}</span>\n          <span className=\"track-card-artista\">\n            {artistas} · {track.album?.name}\n          </span>\n        </div>\n\n        <div className=\"track-card-extra\">\n          <span className=\"track-card-duracion\">\n            {minutos}:{segundos}\n          </span>\n          <span className=\"track-card-popularidad\">\n            Popularidad: {track.popularity}\n          </span>\n        </div>\n      </div>\n\n      <div className=\"track-card-acciones\">\n        <button\n          type=\"button\"\n          className={`track-card-boton track-card-favorito ${\n            esFavorito ? \"track-card-favorito-activo\" : \"\"\n          }`}\n          onClick={() => onToggleFavorito(track)}\n        >\n          {esFavorito ? \"★\" : \"☆\"}\n        </button>\n\n        <button\n          type=\"button\"\n          className=\"track-card-boton track-card-eliminar\"\n          onClick={() => onEliminar(track.id)}\n        >\n          ✕\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"AAAA,4CAA4C;;;;;AAC5C;;AAEe,SAAS,UAAU,EAChC,KAAK,EACL,UAAU,EACV,gBAAgB,EAChB,UAAU,EACX;IACC,MAAM,SACJ,MAAM,KAAK,EAAE,UAAU,MAAM,KAAK,CAAC,MAAM,CAAC,MAAM,GAAG,IAC/C,MAAM,KAAK,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC,MAAM,CAAC,MAAM,GAAG,EAAE,CAAC,GAAG,GACrD;IAEN,MAAM,WAAW,MAAM,OAAO,EAAE,IAAI,CAAC,IAAM,EAAE,IAAI,EAAE,KAAK;IACxD,MAAM,aAAa,MAAM,WAAW,IAAI;IACxC,MAAM,UAAU,KAAK,KAAK,CAAC,aAAa;IACxC,MAAM,WAAW,KAAK,KAAK,CAAC,AAAC,aAAa,QAAS,MAChD,QAAQ,GACR,QAAQ,CAAC,GAAG;IAEf,qBACE,wOAAC;QAAI,WAAU;;YACZ,wBACC,wOAAC;gBAAI,KAAK;gBAAQ,KAAK,MAAM,IAAI;gBAAE,WAAU;;;;;;0BAG/C,wOAAC;gBAAI,WAAU;;kCACb,wOAAC;wBAAI,WAAU;;0CACb,wOAAC;gCAAK,WAAU;0CAAqB,MAAM,IAAI;;;;;;0CAC/C,wOAAC;gCAAK,WAAU;;oCACb;oCAAS;oCAAI,MAAM,KAAK,EAAE;;;;;;;;;;;;;kCAI/B,wOAAC;wBAAI,WAAU;;0CACb,wOAAC;gCAAK,WAAU;;oCACb;oCAAQ;oCAAE;;;;;;;0CAEb,wOAAC;gCAAK,WAAU;;oCAAyB;oCACzB,MAAM,UAAU;;;;;;;;;;;;;;;;;;;0BAKpC,wOAAC;gBAAI,WAAU;;kCACb,wOAAC;wBACC,MAAK;wBACL,WAAW,CAAC,qCAAqC,EAC/C,aAAa,+BAA+B,IAC5C;wBACF,SAAS,IAAM,iBAAiB;kCAE/B,aAAa,MAAM;;;;;;kCAGtB,wOAAC;wBACC,MAAK;wBACL,WAAU;wBACV,SAAS,IAAM,WAAW,MAAM,EAAE;kCACnC;;;;;;;;;;;;;;;;;;AAMT;KA/DwB"}},
    {"offset": {"line": 1370, "column": 0}, "map": {"version":3,"sources":["file:///home/jacobgomez/tercero/Web_I/Practica_Final/spotify2/Final_web/src/components/PlaylistDisplay.jsx"],"sourcesContent":["\"use client\";\n\nimport TrackCard from \"./TrackCard\";\n\nexport default function PlaylistDisplay({\n  tracks,\n  loading,\n  error,\n  onGenerate,\n  onAddMore,\n  isFavorite,\n  onToggleFavorite,\n  onRemoveTrack,\n}) {\n  return (\n    <div className=\"card bloque-playlist\">\n      <div className=\"bloque-cabecera\">\n        <h3 className=\"bloque-titulo\">Playlist generada</h3>\n        <p className=\"bloque-subtitulo\">\n          Aquí aparecen las canciones según tus widgets. Puedes regenerarla,\n          añadir más temas, marcar favoritas o quitar las que no te encajen.\n        </p>\n      </div>\n\n      <div className=\"botones-playlist\">\n        <button\n          type=\"button\"\n          className=\"boton-playlist\"\n          onClick={onGenerate}\n          disabled={loading}\n        >\n          {loading ? \"Generando...\" : \"Generar playlist\"}\n        </button>\n\n        <button\n          type=\"button\"\n          className=\"boton-playlist secundario\"\n          onClick={onAddMore}\n          disabled={loading || tracks.length === 0}\n        >\n          Añadir más canciones\n        </button>\n      </div>\n\n      {error && <p className=\"texto-error-busqueda\">{error}</p>}\n\n      {tracks.length === 0 && !loading && !error && (\n        <p className=\"lista-vacia\">\n          Todavía no hay canciones. Configura tus widgets y pulsa\n          <strong> &quot;Generar playlist&quot;</strong>.\n        </p>\n      )}\n\n      {tracks.length > 0 && (\n        <div className=\"lista-playlist\">\n          {tracks.map((track) => (\n            <TrackCard\n              key={track.id}\n              track={track}\n              esFavorito={isFavorite(track.id)}\n              onToggleFavorito={onToggleFavorite}\n              onEliminar={onRemoveTrack}\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIe,SAAS,gBAAgB,EACtC,MAAM,EACN,OAAO,EACP,KAAK,EACL,UAAU,EACV,SAAS,EACT,UAAU,EACV,gBAAgB,EAChB,aAAa,EACd;IACC,qBACE,wOAAC;QAAI,WAAU;;0BACb,wOAAC;gBAAI,WAAU;;kCACb,wOAAC;wBAAG,WAAU;kCAAgB;;;;;;kCAC9B,wOAAC;wBAAE,WAAU;kCAAmB;;;;;;;;;;;;0BAMlC,wOAAC;gBAAI,WAAU;;kCACb,wOAAC;wBACC,MAAK;wBACL,WAAU;wBACV,SAAS;wBACT,UAAU;kCAET,UAAU,iBAAiB;;;;;;kCAG9B,wOAAC;wBACC,MAAK;wBACL,WAAU;wBACV,SAAS;wBACT,UAAU,WAAW,OAAO,MAAM,KAAK;kCACxC;;;;;;;;;;;;YAKF,uBAAS,wOAAC;gBAAE,WAAU;0BAAwB;;;;;;YAE9C,OAAO,MAAM,KAAK,KAAK,CAAC,WAAW,CAAC,uBACnC,wOAAC;gBAAE,WAAU;;oBAAc;kCAEzB,wOAAC;kCAAO;;;;;;oBAAsC;;;;;;;YAIjD,OAAO,MAAM,GAAG,mBACf,wOAAC;gBAAI,WAAU;0BACZ,OAAO,GAAG,CAAC,CAAC,sBACX,wOAAC,wLAAS;wBAER,OAAO;wBACP,YAAY,WAAW,MAAM,EAAE;wBAC/B,kBAAkB;wBAClB,YAAY;uBAJP,MAAM,EAAE;;;;;;;;;;;;;;;;AAW3B;KAhEwB"}},
    {"offset": {"line": 1499, "column": 0}, "map": {"version":3,"sources":["file:///home/jacobgomez/tercero/Web_I/Practica_Final/spotify2/Final_web/src/app/dashboard/page.js"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useRouter } from \"next/navigation\";\nimport { isAuthenticated } from \"@/lib/auth\";\nimport { buscarCancionesSpotify } from \"@/lib/spotify\";\nimport GenreWidget from \"@/components/Widgets/GenreWidget\";\nimport DecadeWidget from \"@/components/Widgets/DecadeWidget\";\nimport PopularityWidget from \"@/components/Widgets/PopularityWidget\";\nimport ArtistWidget from \"@/components/Widgets/ArtistWidget\";\nimport TrackWidget from \"@/components/Widgets/TrackWidget\";\nimport PlaylistDisplay from \"@/components/PlaylistDisplay\"; \nimport TrackCard from \"@/components/TrackCard\";\nimport {\n  obtenerTopTracksArtista,\n  buscarTracksPorGenero,\n} from \"@/lib/spotify\";\n\n\n\n\nexport default function DashboardPage() {\n  const [image, setImage] = useState(null);\n  const [error, setError] = useState('');\n\n  const router = useRouter();\n\n  const [preferencias, setPreferencias] = useState({\n    artistas: [],\n    canciones: [],\n    generos: [],\n    decadas: [],\n    popularidad: { min: 30, max: 90 },\n    mood: { energia: 0.7, valencia: 0.7, baile: 0.7 },\n  });\n\n\n  const [listaReproduccion, setListaReproduccion] = useState([]);\n  const [favoritos, setFavoritos] = useState([]);\n  const [cargandoPlaylist, setCargandoPlaylist] = useState(false);\n  const [errorPlaylist, setErrorPlaylist] = useState(\"\");\n\n  // Si no está autenticado, devolverlo al inicio\n  useEffect(() => {\n    if (!isAuthenticated()) {\n      router.push(\"/\");\n    }\n  }, [router]);\n\n  // Cargar favoritos desde localStorage (si existen)\n   useEffect(() => {\n    try {\n      const guardados = localStorage.getItem(\"favorite_tracks\");\n      if (guardados) {\n        setFavoritos(JSON.parse(guardados));\n      }\n    } catch (error) {\n      console.error(\"Error leyendo favoritos de localStorage\", error);\n    }\n  }, []);\n\n  // Convertir \"1980s\" -> {min: 1980, max: 1989}\nfunction rangoDecada(decada) {\n  const inicio = parseInt(decada.slice(0, 4), 10);\n  if (Number.isNaN(inicio)) return null;\n  return { min: inicio, max: inicio + 9 };\n}\n\nfunction anioDeTrack(track) {\n  const fecha = track.album?.release_date;\n  if (!fecha) return null;\n  // formato \"YYYY-MM-DD\" o \"YYYY\"\n  const anio = parseInt(fecha.slice(0, 4), 10);\n  return Number.isNaN(anio) ? null : anio;\n}\n\n// Generar playlist usando las preferencias\nasync function generarPlaylist() {\n  setCargandoPlaylist(true);\n  setErrorPlaylist(\"\");\n\n  try {\n    let tracks = [];\n\n    // 1) Top tracks de artistas seleccionados\n    for (const artista of preferencias.artistas.slice(0, 3)) {\n      const topTracks = await obtenerTopTracksArtista(artista.id);\n      tracks.push(...topTracks.slice(0, 5)); // 5 por artista\n    }\n\n    // 2) Canciones por género\n    for (const genero of preferencias.generos.slice(0, 3)) {\n      const tracksGenero = await buscarTracksPorGenero(genero, 8);\n      tracks.push(...tracksGenero);\n    }\n\n    // 3) Añadir canciones seleccionadas directamente en el widget de canciones\n    tracks.push(...preferencias.canciones);\n\n    // 4) Eliminar duplicados por id\n    const mapa = new Map();\n    for (const t of tracks) {\n      if (!mapa.has(t.id)) {\n        mapa.set(t.id, t);\n      }\n    }\n    tracks = Array.from(mapa.values());\n\n    // 5) Filtrar por popularidad\n    const { min, max } = preferencias.popularidad;\n    tracks = tracks.filter(\n      (t) => t.popularity >= min && t.popularity <= max\n    );\n\n    // 6) Filtrar por década (si se han seleccionado)\n    if (preferencias.decadas.length > 0) {\n      const rangos = preferencias.decadas\n        .map(rangoDecada)\n        .filter(Boolean);\n\n      tracks = tracks.filter((t) => {\n        const anio = anioDeTrack(t);\n        if (!anio) return false;\n        return rangos.some((r) => anio >= r.min && anio <= r.max);\n      });\n    }\n\n    // 7) Limitar tamaño final (por ejemplo 30 canciones)\n    tracks = tracks.slice(0, 30);\n\n    setListaReproduccion(tracks);\n  } catch (error) {\n    console.error(error);\n    setErrorPlaylist(\n      error.message || \"Error al generar la playlist. Inténtalo de nuevo.\"\n    );\n    setListaReproduccion([]);\n  } finally {\n    setCargandoPlaylist(false);\n  }\n}\n\n// Añadir más canciones sobre la playlist actual\nasync function agregarMasCanciones() {\n  if (listaReproduccion.length === 0) {\n    await generarPlaylist();\n    return;\n  }\n\n  setCargandoPlaylist(true);\n  setErrorPlaylist(\"\");\n\n  try {\n    let nuevas = [];\n\n    for (const artista of preferencias.artistas.slice(0, 2)) {\n      const topTracks = await obtenerTopTracksArtista(artista.id);\n      nuevas.push(...topTracks.slice(0, 5));\n    }\n\n    for (const genero of preferencias.generos.slice(0, 2)) {\n      const tracksGenero = await buscarTracksPorGenero(genero, 5);\n      nuevas.push(...tracksGenero);\n    }\n\n    const mapa = new Map();\n    for (const t of [...listaReproduccion, ...nuevas]) {\n      if (!mapa.has(t.id)) {\n        mapa.set(t.id, t);\n      }\n    }\n\n    setListaReproduccion(Array.from(mapa.values()).slice(0, 50));\n  } catch (error) {\n    console.error(error);\n    setErrorPlaylist(\n      error.message || \"Error al añadir más canciones.\"\n    );\n  } finally {\n    setCargandoPlaylist(false);\n  }\n}\n\n// Eliminar una canción de la playlist\nfunction eliminarTrackDePlaylist(idTrack) {\n  setListaReproduccion((prev) => prev.filter((t) => t.id !== idTrack));\n}\n\n// Toggle favorito y persistir en localStorage\nfunction toggleFavorito(track) {\n  setFavoritos((prev) => {\n    const existe = prev.some((t) => t.id === track.id);\n    let nuevaLista;\n\n    if (existe) {\n      nuevaLista = prev.filter((t) => t.id !== track.id);\n    } else {\n      nuevaLista = [...prev, track];\n    }\n\n    if (typeof window !== \"undefined\") {\n      try {\n        localStorage.setItem(\n          \"favorite_tracks\",\n          JSON.stringify(nuevaLista)\n        );\n      } catch (error) {\n        console.error(\"Error guardando favoritos en localStorage\", error);\n      }\n    }\n\n    return nuevaLista;\n  });\n}\n\nfunction esFavorito(trackId) {\n  return favoritos.some((t) => t.id === trackId);\n}\n\nreturn (\n  <section className=\"dashboard\">\n    <div className=\"dashboard-contenedor\">\n      <div className=\"dashboard-columna-izquierda\">\n        <header className=\"dashboard-cabecera\">\n            <h2 className=\"dashboard-titulo\">Panel de mezcla\n            <p className=\"dashboard-texto\">\n              Configura tus preferencias con los widgets (artistas, géneros,\n              décadas, etc.) y genera una playlist personalizada.\n            </p>\n            </h2>\n           </header>\n\n            <div className=\"grid-widgets\">\n              <GenreWidget\n                  generosSeleccionados={preferencias.generos}\n                  onCambiarGeneros={(nuevosGeneros) =>\n                    setPreferencias((previas) => ({\n                      ...previas,\n                      generos: nuevosGeneros,\n                    }))\n                  }\n                />\n            </div>\n\n            <DecadeWidget\n              decadasSeleccionadas={preferencias.decadas}\n              onCambiarDecadas={(nuevasDecadas) =>\n                setPreferencias((previas) => ({\n                  ...previas,\n                  decadas: nuevasDecadas,\n                }))\n              }\n            />\n\n\n            <PopularityWidget\n              popularidad={preferencias.popularidad}\n              onCambiarPopularidad={(nuevaPopularidad) =>\n                setPreferencias((previas) => ({\n                  ...previas,\n                  popularidad: nuevaPopularidad,\n                }))\n              }\n            />\n            <ArtistWidget\n              artistasSeleccionados={preferencias.artistas}\n              onCambiarArtistas={(nuevosArtistas) =>\n                setPreferencias((previas) => ({\n                  ...previas,\n                  artistas: nuevosArtistas,\n                }))\n              }\n            />\n            <TrackWidget\n              cancionesSeleccionadas={preferencias.canciones}\n              onCambiarCanciones={(nuevasCanciones) =>\n                setPreferencias((previas) => ({\n                  ...previas,\n                  canciones: nuevasCanciones,\n                }))\n              }\n            />\n      </div>\n\n      <div className=\"dashboard-columna-derecha\">\n         <div className=\"card bloque-playlist\">\n            <PlaylistDisplay\n              tracks={listaReproduccion}\n              loading={cargandoPlaylist}\n              error={errorPlaylist}\n              onGenerate={generarPlaylist}\n              onAddMore={agregarMasCanciones}\n              isFavorite={esFavorito}\n              onToggleFavorite={toggleFavorito}\n              onRemoveTrack={eliminarTrackDePlaylist}\n            />\n        <div className=\"card bloque-favoritos\">\n          <div className=\"bloque-cabecera\">\n            <h3 className=\"bloque-titulo\">Tus canciones favoritas</h3>\n            <p className=\"bloque-subtitulo\">\n              Se guardan en <code>localStorage</code>. Puedes marcarlas desde la playlist.\n            </p>\n          </div>\n\n          {favoritos.length === 0 ? (\n            <p className=\"lista-vacia\">\n              Aún no has marcado ninguna canción como favorita.\n            </p>\n          ) : (\n            <ul className=\"lista-favoritos\">\n              {favoritos.map((track) => (\n                <li key={track.id}>\n                  {track.name} ·{\" \"}\n                  {track.artists?.map((a) => a.name).join(\", \")}\n                </li>\n              ))}\n            </ul>\n          )}\n        </div>\n        </div>\n      </div>\n    </div>\n  </section>\n);}"],"names":[],"mappings":"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"}}]
}