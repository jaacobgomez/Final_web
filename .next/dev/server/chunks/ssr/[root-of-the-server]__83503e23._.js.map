{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///home/jacobgomez/tercero/Web_I/Practica_Final/spotify2/Final_web/src/lib/auth.js"],"sourcesContent":["// Generar string aleatorio para el par谩metro 'state'\nexport function generateRandomString(length) {\n  const possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  let text = '';\n  for (let i = 0; i < length; i++) {\n    text += possible.charAt(Math.floor(Math.random() * possible.length));\n  }\n  return text;\n}\n\n// Construir URL de autorizaci贸n de Spotify\nexport function getSpotifyAuthUrl() {\n  const clientId = process.env.NEXT_PUBLIC_SPOTIFY_CLIENT_ID || '';\n  const redirectUri = process.env.NEXT_PUBLIC_REDIRECT_URI || '';\n  const state = generateRandomString(16);\n\n  // Guardar el state para validaci贸n posterior (prevenir CSRF)\n  if (typeof window !== 'undefined') {\n    localStorage.setItem('spotify_auth_state', state);\n  }\n\n  const scope = [\n    'user-read-private',\n    'user-read-email',\n    'user-top-read',\n    'playlist-modify-public',\n    'playlist-modify-private'\n  ].join(' ');\n\n  const params = new URLSearchParams({\n    client_id: clientId,\n    response_type: 'code',\n    redirect_uri: redirectUri,\n    state: state,\n    scope: scope\n  });\n\n  return `https://accounts.spotify.com/authorize?${params.toString()}`;\n}\n\n// Guardar tokens en localStorage\nexport function saveTokens(accessToken, refreshToken, expiresIn) {\n  const expirationTime = Date.now() + expiresIn * 1000;\n  localStorage.setItem('spotify_token', accessToken);\n  localStorage.setItem('spotify_refresh_token', refreshToken);\n  localStorage.setItem('spotify_token_expiration', expirationTime.toString());\n}\n\n// Obtener token actual (con verificaci贸n de expiraci贸n)\nexport function getAccessToken() {\n  const token = localStorage.getItem('spotify_token');\n  const expiration = localStorage.getItem('spotify_token_expiration');\n  \n  if (!token || !expiration) return null;\n  \n  // Si el token expir贸, retornar null\n  if (Date.now() > parseInt(expiration)) {\n    return null;\n  }\n  \n  return token;\n}\n\n// Verificar si hay token v谩lido\nexport function isAuthenticated() {\n  return getAccessToken() !== null;\n}\n\n// Cerrar sesi贸n\nexport function logout() {\n  localStorage.removeItem('spotify_token');\n  localStorage.removeItem('spotify_refresh_token');\n  localStorage.removeItem('spotify_token_expiration');\n}"],"names":[],"mappings":"AAAA,qDAAqD;;;;;;;;;;;;;;;AAC9C,SAAS,qBAAqB,MAAM;IACzC,MAAM,WAAW;IACjB,IAAI,OAAO;IACX,IAAK,IAAI,IAAI,GAAG,IAAI,QAAQ,IAAK;QAC/B,QAAQ,SAAS,MAAM,CAAC,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,SAAS,MAAM;IACpE;IACA,OAAO;AACT;AAGO,SAAS;IACd,MAAM,WAAW,wEAA6C;IAC9D,MAAM,cAAc,2EAAwC;IAC5D,MAAM,QAAQ,qBAAqB;IAEnC,6DAA6D;IAC7D;;IAIA,MAAM,QAAQ;QACZ;QACA;QACA;QACA;QACA;KACD,CAAC,IAAI,CAAC;IAEP,MAAM,SAAS,IAAI,gBAAgB;QACjC,WAAW;QACX,eAAe;QACf,cAAc;QACd,OAAO;QACP,OAAO;IACT;IAEA,OAAO,CAAC,uCAAuC,EAAE,OAAO,QAAQ,IAAI;AACtE;AAGO,SAAS,WAAW,WAAW,EAAE,YAAY,EAAE,SAAS;IAC7D,MAAM,iBAAiB,KAAK,GAAG,KAAK,YAAY;IAChD,aAAa,OAAO,CAAC,iBAAiB;IACtC,aAAa,OAAO,CAAC,yBAAyB;IAC9C,aAAa,OAAO,CAAC,4BAA4B,eAAe,QAAQ;AAC1E;AAGO,SAAS;IACd,MAAM,QAAQ,aAAa,OAAO,CAAC;IACnC,MAAM,aAAa,aAAa,OAAO,CAAC;IAExC,IAAI,CAAC,SAAS,CAAC,YAAY,OAAO;IAElC,oCAAoC;IACpC,IAAI,KAAK,GAAG,KAAK,SAAS,aAAa;QACrC,OAAO;IACT;IAEA,OAAO;AACT;AAGO,SAAS;IACd,OAAO,qBAAqB;AAC9B;AAGO,SAAS;IACd,aAAa,UAAU,CAAC;IACxB,aAAa,UAAU,CAAC;IACxB,aAAa,UAAU,CAAC;AAC1B"}},
    {"offset": {"line": 102, "column": 0}, "map": {"version":3,"sources":["file:///home/jacobgomez/tercero/Web_I/Practica_Final/spotify2/Final_web/src/components/Cabecera.jsx"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport { usePathname, useRouter } from \"next/navigation\";\nimport { useEffect, useState } from \"react\";\nimport { isAuthenticated } from \"@/lib/auth\";\n\nexport default function Cabecera() {\n  const rutaActual = usePathname();\n  const router = useRouter();\n  const [autenticado, setAutenticado] = useState(false);\n\n  // Verificar estado de autenticaci贸n al cargar y cuando la ruta cambie\n    useEffect(() => {\n    try {\n      setAutenticado(isAuthenticated());\n    } catch (error) {\n      setAutenticado(false);\n    }\n  }, [rutaActual, isAuthenticated]);\n\n\n  // IMPORTANTE: el nombre de la funci贸n coincide con el onClick\n  const manejarLogout = () => {\n    if (typeof window !== \"undefined\") {\n      localStorage.removeItem(\"spotify_token\");\n      localStorage.removeItem(\"spotify_refresh_token\");\n      localStorage.removeItem(\"spotify_token_expiration\");\n    }\n    setAutenticado(false);\n    router.push(\"/\");\n  };\n\n  return (\n    <header className=\"header\">\n      <div className=\"logo-nav-container\">\n        {/* Lado izquierdo: logo + t铆tulo */}\n        <div className=\"titulo-logo\">\n          <span className=\"logo-emoji\"></span>\n          <div>\n            <h1 className=\"titulo-logo-Spotify\">Spotify Taste Mixer</h1>\n            <p className=\"texto-subtitulo\">\n              Mezcla tus gustos y descubre m煤sica\n            </p>\n          </div>\n        </div>\n\n        {/* Lado derecho: menu + sesi贸n */}\n        <nav className=\"nav-links\">\n          <ul className=\"nav-ul\">\n            <li>\n              <Link\n                href=\"/\"\n                className={`inicio ${\n                  rutaActual === \"/\" ? \"bg-white/10\" : \"\"\n                }`}\n              >\n                Inicio\n              </Link>\n            </li>\n\n            <li className=\"panel-li\">\n              <Link\n                href=\"/dashboard\"\n                className={`panel ${\n                  rutaActual?.startsWith(\"/dashboard\") ? \"bg-white/10\" : \"\"\n                }`}\n              >\n                Panel\n              </Link>\n            </li>\n\n            <li>\n              {autenticado ? (\n                <button\n                  onClick={manejarLogout}\n                  className=\"cerrar-sesion-button\"\n                >\n                  Cerrar sesi贸n\n                </button>\n              ) : (\n                <span className=\"iniciar-sesion-texto\">\n                  Inicia sesi贸n para ver el panel\n                </span>\n              )}\n            </li>\n          </ul>\n        </nav>\n      </div>\n    </header>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOe,SAAS;IACtB,MAAM,aAAa,IAAA,4LAAW;IAC9B,MAAM,SAAS,IAAA,0LAAS;IACxB,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,4PAAQ,EAAC;IAE/C,sEAAsE;IACpE,IAAA,6PAAS,EAAC;QACV,IAAI;YACF,eAAe,IAAA,gLAAe;QAChC,EAAE,OAAO,OAAO;YACd,eAAe;QACjB;IACF,GAAG;QAAC;QAAY,gLAAe;KAAC;IAGhC,8DAA8D;IAC9D,MAAM,gBAAgB;QACpB;;QAKA,eAAe;QACf,OAAO,IAAI,CAAC;IACd;IAEA,qBACE,yRAAC;QAAO,WAAU;kBAChB,cAAA,yRAAC;YAAI,WAAU;;8BAEb,yRAAC;oBAAI,WAAU;;sCACb,yRAAC;4BAAK,WAAU;sCAAa;;;;;;sCAC7B,yRAAC;;8CACC,yRAAC;oCAAG,WAAU;8CAAsB;;;;;;8CACpC,yRAAC;oCAAE,WAAU;8CAAkB;;;;;;;;;;;;;;;;;;8BAOnC,yRAAC;oBAAI,WAAU;8BACb,cAAA,yRAAC;wBAAG,WAAU;;0CACZ,yRAAC;0CACC,cAAA,yRAAC,kNAAI;oCACH,MAAK;oCACL,WAAW,CAAC,OAAO,EACjB,eAAe,MAAM,gBAAgB,IACrC;8CACH;;;;;;;;;;;0CAKH,yRAAC;gCAAG,WAAU;0CACZ,cAAA,yRAAC,kNAAI;oCACH,MAAK;oCACL,WAAW,CAAC,MAAM,EAChB,YAAY,WAAW,gBAAgB,gBAAgB,IACvD;8CACH;;;;;;;;;;;0CAKH,yRAAC;0CACE,4BACC,yRAAC;oCACC,SAAS;oCACT,WAAU;8CACX;;;;;yDAID,yRAAC;oCAAK,WAAU;8CAAuB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUvD"}}]
}