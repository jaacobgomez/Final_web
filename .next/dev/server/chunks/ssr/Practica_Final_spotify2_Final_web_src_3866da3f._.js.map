{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/jacobgomez/tercero/Web_I/Practica_Final/spotify2/Final_web/src/lib/spotify.js"],"sourcesContent":["import { getAccessToken } from './auth';\n\nexport async function generatePlaylist(preferences) {\n  const { artists, genres, decades, popularity } = preferences;\n  const token = getAccessToken();\n  let allTracks = [];\n\n  // 1. Obtener top tracks de artistas seleccionados\n  for (const artist of artists) {\n    const tracks = await fetch(\n      `https://api.spotify.com/v1/artists/${artist.id}/top-tracks?market=US`,\n      {\n        headers: { 'Authorization': `Bearer ${token}` }\n      }\n    );\n    const data = await tracks.json();\n    allTracks.push(...data.tracks);\n  }\n\n  // 2. Buscar por géneros\n  for (const genre of genres) {\n    const results = await fetch(\n      `https://api.spotify.com/v1/search?type=track&q=genre:${genre}&limit=20`,\n      {\n        headers: { 'Authorization': `Bearer ${token}` }\n      }\n    );\n    const data = await results.json();\n    allTracks.push(...data.tracks.items);\n  }\n\n  // 3. Filtrar por década\n  if (decades.length > 0) {\n    allTracks = allTracks.filter(track => {\n      const year = new Date(track.album.release_date).getFullYear();\n      return decades.some(decade => {\n        const decadeStart = parseInt(decade);\n        return year >= decadeStart && year < decadeStart + 10;\n      });\n    });\n  }\n\n  // 4. Filtrar por popularidad\n  if (popularity) {\n    const [min, max] = popularity;\n    allTracks = allTracks.filter(\n      track => track.popularity >= min && track.popularity <= max\n    );\n  }\n\n  // 5. Eliminar duplicados y limitar a 30 canciones\n  const uniqueTracks = Array.from(\n    new Map(allTracks.map(track => [track.id, track])).values()\n  ).slice(0, 30);\n\n  return uniqueTracks;\n}\n\nexport async function getRandomSpotifyImage() {\n  const token = getAccessToken();\n  if (!token) {\n    throw new Error('No hay token de Spotify. Inicia sesión primero.');\n  }\n\n  const res = await fetch(\n    'https://api.spotify.com/v1/browse/new-releases?limit=20',\n    {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    }\n  );\n\n  if (!res.ok) {\n    const text = await res.text();\n    console.error('Error al pedir new releases:', res.status, text);\n    throw new Error('Error al pedir datos a Spotify');\n  }\n\n  const data = await res.json();\n  const albums = data.albums.items;\n  if (!albums.length) {\n    throw new Error('Spotify no devolvió álbumes');\n  }\n\n  const randomIndex = Math.floor(Math.random() * albums.length);\n  const album = albums[randomIndex];\n\n  return {\n    url: album.images[0]?.url || '',\n    name: album.name,\n    artist: album.artists?.[0]?.name || '',\n  };\n}"],"names":[],"mappings":";;;;;;AAAA;;AAEO,eAAe,iBAAiB,WAAW;IAChD,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE,OAAO,EAAE,UAAU,EAAE,GAAG;IACjD,MAAM,QAAQ,IAAA,+KAAc;IAC5B,IAAI,YAAY,EAAE;IAElB,kDAAkD;IAClD,KAAK,MAAM,UAAU,QAAS;QAC5B,MAAM,SAAS,MAAM,MACnB,CAAC,mCAAmC,EAAE,OAAO,EAAE,CAAC,qBAAqB,CAAC,EACtE;YACE,SAAS;gBAAE,iBAAiB,CAAC,OAAO,EAAE,OAAO;YAAC;QAChD;QAEF,MAAM,OAAO,MAAM,OAAO,IAAI;QAC9B,UAAU,IAAI,IAAI,KAAK,MAAM;IAC/B;IAEA,wBAAwB;IACxB,KAAK,MAAM,SAAS,OAAQ;QAC1B,MAAM,UAAU,MAAM,MACpB,CAAC,qDAAqD,EAAE,MAAM,SAAS,CAAC,EACxE;YACE,SAAS;gBAAE,iBAAiB,CAAC,OAAO,EAAE,OAAO;YAAC;QAChD;QAEF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,UAAU,IAAI,IAAI,KAAK,MAAM,CAAC,KAAK;IACrC;IAEA,wBAAwB;IACxB,IAAI,QAAQ,MAAM,GAAG,GAAG;QACtB,YAAY,UAAU,MAAM,CAAC,CAAA;YAC3B,MAAM,OAAO,IAAI,KAAK,MAAM,KAAK,CAAC,YAAY,EAAE,WAAW;YAC3D,OAAO,QAAQ,IAAI,CAAC,CAAA;gBAClB,MAAM,cAAc,SAAS;gBAC7B,OAAO,QAAQ,eAAe,OAAO,cAAc;YACrD;QACF;IACF;IAEA,6BAA6B;IAC7B,IAAI,YAAY;QACd,MAAM,CAAC,KAAK,IAAI,GAAG;QACnB,YAAY,UAAU,MAAM,CAC1B,CAAA,QAAS,MAAM,UAAU,IAAI,OAAO,MAAM,UAAU,IAAI;IAE5D;IAEA,kDAAkD;IAClD,MAAM,eAAe,MAAM,IAAI,CAC7B,IAAI,IAAI,UAAU,GAAG,CAAC,CAAA,QAAS;YAAC,MAAM,EAAE;YAAE;SAAM,GAAG,MAAM,IACzD,KAAK,CAAC,GAAG;IAEX,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,QAAQ,IAAA,+KAAc;IAC5B,IAAI,CAAC,OAAO;QACV,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,MAAM,MAAM,MAChB,2DACA;QACE,SAAS;YACP,eAAe,CAAC,OAAO,EAAE,OAAO;QAClC;IACF;IAGF,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,QAAQ,KAAK,CAAC,gCAAgC,IAAI,MAAM,EAAE;QAC1D,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,OAAO,MAAM,IAAI,IAAI;IAC3B,MAAM,SAAS,KAAK,MAAM,CAAC,KAAK;IAChC,IAAI,CAAC,OAAO,MAAM,EAAE;QAClB,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,cAAc,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,OAAO,MAAM;IAC5D,MAAM,QAAQ,MAAM,CAAC,YAAY;IAEjC,OAAO;QACL,KAAK,MAAM,MAAM,CAAC,EAAE,EAAE,OAAO;QAC7B,MAAM,MAAM,IAAI;QAChB,QAAQ,MAAM,OAAO,EAAE,CAAC,EAAE,EAAE,QAAQ;IACtC;AACF"}},
    {"offset": {"line": 90, "column": 0}, "map": {"version":3,"sources":["file:///home/jacobgomez/tercero/Web_I/Practica_Final/spotify2/Final_web/src/app/dashboard/page.js"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { getRandomSpotifyImage } from '@/lib/spotify';\n\nexport default function DashboardPage() {\n  const [image, setImage] = useState(null);\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    getRandomSpotifyImage()\n      .then(setImage)\n      .catch((err) => {\n        console.error(err);\n        setError(err.message);\n      });\n  }, []);\n\n  return (\n    <div>\n      <h1>Estamos en el Dashboard</h1>\n      {/* Contenido del dashboard */}\n      {error && (\n        <p className=\"text-red-500 mb-4\">\n          Error: {error}\n        </p>\n      )}\n      {image && (\n        <div className=\"flex flex-col items-center gap-4\">\n          <p className=\"text-lg\">\n            {image.name} — {image.artist}\n          </p>\n          <img src={image.url} alt={image.name}/>\n        </div>\n      )}\n    </div>\n  );\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAKe,SAAS;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,4PAAQ,EAAC;IACnC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,4PAAQ,EAAC;IAEnC,IAAA,6PAAS,EAAC;QACR,IAAA,yLAAqB,IAClB,IAAI,CAAC,UACL,KAAK,CAAC,CAAC;YACN,QAAQ,KAAK,CAAC;YACd,SAAS,IAAI,OAAO;QACtB;IACJ,GAAG,EAAE;IAEL,qBACE,yRAAC;;0BACC,yRAAC;0BAAG;;;;;;YAEH,uBACC,yRAAC;gBAAE,WAAU;;oBAAoB;oBACvB;;;;;;;YAGX,uBACC,yRAAC;gBAAI,WAAU;;kCACb,yRAAC;wBAAE,WAAU;;4BACV,MAAM,IAAI;4BAAC;4BAAI,MAAM,MAAM;;;;;;;kCAE9B,yRAAC;wBAAI,KAAK,MAAM,GAAG;wBAAE,KAAK,MAAM,IAAI;;;;;;;;;;;;;;;;;;AAK9C"}}]
}